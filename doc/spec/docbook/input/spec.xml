<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "../docbook-xml-4.5/docbookx.dtd">

<book>
  <title>Спецификация hint плагина к редактору Sublime Text</title>

  <bookinfo>
    <title>Спецификация hint плагина к редактору Sublime Text</title>
    <author>
      <firstname>Михаил</firstname>
      <surname>Голубев</surname>
    </author>
    <author>
      <firstname>Семен</firstname>
      <surname>Колтон</surname>
    </author>
    <author>
      <firstname>Александр</firstname>
      <surname>Половцев</surname>
    </author>
    <author>
      <firstname>Дмитрий</firstname>
      <surname>Скотников</surname>
    </author>
    <author>
      <firstname>Яромир</firstname>
      <surname>Шпилевский</surname>
    </author>
    <volumenum>1</volumenum>
  </bookinfo>

  <chapter>
    <title>О плагине</title>
    <section>
      <title>Назначение</title>
      <para>
        Данный плагин позволяет отображать в редакторе Sublime подсказки (хинты) к произвольным участкам текста.
        Область применения данного плагина может быть различной: от рецензирования plain-text документов до отображения метаданных для программного кода.
      </para>
      <section>
        <title>Условные обозначения документа</title>
        <para>TBD (Если таковые возникнут)</para>
      </section>
      <section>
        <title>Для кого предназначен этот документ</title>
        <para>
          Документ содержит различные технические спецификации, как, например, формат файла с подсказками и может быть полезен разработчикам и инженерам обеспечения качества.
        </para>
      </section>
    </section>
    <section>
      <title>Ссылки</title>
      <para>
        TBD
      </para>
    </section>
  </chapter>

  <chapter>
    <title>Общее описание</title>
    <section>
      <title>Функции плагина</title>
      <para>
        Плагин должен отображать подсказки из файла подсказок, ассоциированного с отображаемым файлом. Формат файла подсказок описан в главе "Программные интерфейсы".
      </para>
    </section>
    <section>
      <title>Целевая платформа</title>
      <para>
        Плагин должен работать с редактором Sublime Text 2.<sbr/>
        Поддержка версии 3 пока не гарантируется.<sbr/>
        Требования к версии интерпретатора Python, используемой ОС и аппаратной части целиком определяются таковыми для Sublime.
      </para>
    </section>
    <section>
      <title>Ограничения дизайна и реализации</title>
      <itemizedlist>
        <listitem>
        <para>
        Плагин ограничен возможностями API Sublime.
        </para>
        </listitem>
        <listitem>
        <para>
        Подключение сторонних компонентов, написанных на Python, затруднено из-за того, что редактор Sublime не является отдельным набором Python скриптов, выполняющимся на интерпретаторе Python, установленном в ОС, а представляет собой исполняемый файл, в который встроена минимально необходимая среда выполнения Python и сам код.
        </para>
        </listitem>
        <listitem>
        <para>
          Вставка бинарных исполняемых файлов и их использование через байндинги к Python также затруднена, так как плагин должен иметь возможность устанавливаться через Package Control.
        </para>
        </listitem>
      </itemizedlist>
    </section>
    <section>
      <title>Программная документация</title>
      <para>
        TBD (если будет)
      </para>
    </section>
    <section>
      <title>Пользовательская документация</title>
      <para>
        TBD (если будет)
      </para>
    </section>
  </chapter>

  <chapter>
    <title>Внешние интерфейсы</title>
    <section>
      <title>Программные интерфейсы</title>
      <section>
        <title>Формат файла подсказок</title>
        <para>
          Одним из программных интерфейсов является формат файла подсказок. Этот файл является JSON документом следующего формата:
          <programlisting>
{
    "created" : "",
    "modified" : "",
    "author" : "",
    "createdWith" : "",
    "sourceFileHash" : "",
    "tags" : [
        "tag1",
        "tag2"
    ],
    "hints": [
        {
            "text": "Ham! Spam! Spam! Spam! Eggs! Sausages!",
            "places": [[0, 0, 0, 10], [10, 2, 20, 42]]
        },
        {
            "text": "Dead parrot",
            "places": [[3, 12, 3, 80]]
        }
    ]
}
          </programlisting>
        </para>
      </section>
    </section>
    <section>
      <title>Свойства плагина</title>
      <section>
        <title>Расположение файла подсказок</title>
        <para>
          По умолчанию файл подсказок - это файл в той же директории, что и исходный текст.<sbr/>
          Имя файла - имя и расширение исходного файла с добавлением расширения hints.
        </para>
      </section>
      <section>
        <title>Отображение подсказок</title>
        <para>
          Отображение подсказок возможно несколькими способами.
        </para>
        <section>
          <title>Отображение в виде разворачиваемой строки</title>
          <para>
            При таком способе отображения подсказки вставляются в исходный текст в виде сворачиваемых участков.<sbr/>
            По горячей клавише (задается в Preferences -> Key Bindings - User) открывается копия исходного файла, в который вставлены подсказки, при этом подсказка свернута, а соответствующий ей текст подсвечен. Пример приведен на рис.1
            <mediaobject>
              <imageobject>
                <imagedata fileref="spec-images/area-folded.png"/>
              </imageobject>
              <textobject>
                <phrase>Рис.1 Подсвеченный участок текста.</phrase>
              </textobject>
            </mediaobject>
            Рис.1 Подсвеченный участок текста.<sbr/><sbr/>
            При клике на треугольнике рядом с номером последней строки участка текста, для которого есть подсказка, происходит разворачивание подсказки, обрамленной определенными символами, как показано на рис.2
            <mediaobject>
              <imageobject>
                <imagedata fileref="spec-images/area-unfolded.png"/>
              </imageobject>
              <textobject>
                <phrase>Рис.2 Развернутая подсказка.</phrase>
              </textobject>
            </mediaobject>
            Рис.2 Развернутая подсказка.
          </para>
        </section>
      </section>
    </section>
  </chapter>

  <chapter>
    <title>Список TBD</title>
    <para>
      <itemizedlist>
        <listitem>
        <para>Условные обозначения документа</para>
        </listitem>
        <listitem>
        <para>Ссылки</para>
        </listitem>
        <listitem>
        <para>Программная документация</para>
        </listitem>
        <listitem>
        <para>Пользовательская документация</para>
        </listitem>
      </itemizedlist>
    </para>
  </chapter>

</book>

