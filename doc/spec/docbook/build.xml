<?xml version="1.0"?>
<!--
Based on the tutorial by Lars Vogel.
http://www.vogella.com/articles/DocBook/article.html
-->
<project name="Sublime Hint Plugin Specification" default="build-html">

  <description>
    Used to transform DocBook XML to HTML5 output
  </description>

  <!-- Define base properties -->
  <property name="input.dir" value="input" />
  <property name="output.dir" value="output" />
  <property name="docbook.xsl.dir" value="docbook-xsl-1.78.0" />
  <property name="xhtml5.stylesheet" value="../${docbook.xsl.dir}/xhtml5/docbook.xsl" />

  <!-- Making saxon available -->
  <path id="saxon.class.path">
    <pathelement location="lib/saxon-6.5.5.jar" />
  </path>

  <!-- - target: usage -->
  <target name="usage" description="Prints help">
    <echo message="Use -projecthelp to get a list of the available targets." />
  </target>

  <!-- - target: clean -->
  <target name="clean" description="Cleans up generated files.">
    <delete dir="${output.dir}" />
  </target>

  <!-- - target: depends -->
  <target name="createtargetdir" description="Generate targetdir.">
    <mkdir dir="${output.dir}" />
    <mkdir dir="${output.dir}/spec-images" />
  </target>

  <target name="build-html" depends="clean, createtargetdir"
    description="Generates HTML5 files">
    <echo message="Building HTML5 output" />

    <!-- Copy the stylesheet to the same directory as the HTML files -->
    <copy todir="${output.dir}">
      <fileset dir="css">
        <include name="style.css" />
      </fileset>
    </copy>

    <!-- Copy the images to the same directory as the HTML files -->
    <copy todir="${output.dir}\spec-images">
      <fileset dir="${input.dir}\spec-images">
      </fileset>
    </copy>
    <!-- Transfer to HTML -->
    <xslt style="${xhtml5.stylesheet}" extension=".html" basedir="${input.dir}" destdir="${output.dir}">
      <include name="**/spec.xml" />
      <param name="html.stylesheet" expression="style.css" />
      <param name="docbook.css.source" expression="" />
      <param name="section.autolabel" expression="1" />
      <param name="make.clean.html" expression="1" />
      <outputproperty name="indent" value="yes" />
      <classpath refid="saxon.class.path" />
    </xslt>
  </target>

</project>

